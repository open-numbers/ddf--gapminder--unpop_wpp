info:
    id: unpop_sg_dataset
    base:
        - &d1 open-numbers/ddf--unpop--world_population_prospects

config:
    recipes_dir: ./
    dictionary_dir: ../translation_dictionaries

include:
    - recipe_gw_common.yaml
    - recipe_unpop-1.yaml
    - recipe_unpop-2.yaml
    - recipe_unpop-3.yaml
    - recipe_unpop-4.yaml
    - recipe_unpop-5.yaml


cooking:
    datapoints:
        - procedure: merge
          ingredients:
              - unpop-datapoints-1-final
              - unpop-datapoints-2-final
              - unpop-datapoints-3-final
              - unpop-datapoints-4-final
              - unpop-datapoints-5-final
          result: unpop-datapoints-final-0
        - procedure: translate_header
          ingredients:
              - unpop-datapoints-final-0
          options:
              dictionary:
                  country: geo
          result: unpop-datapoints-final

    concepts:
        - procedure: extract_concepts
          ingredients:
              -  unpop-datapoints-final
          result: unpop-datapoints-concepts
        - procedure: merge
          ingredients:
              - unpop-datapoints-concepts
              - gw-concepts-geo
              - gw-concepts-discrete
          options:
              deep: true
          result: concepts-final

serving:
    - id: unpop-datapoints-final
    - id: gw-entities-geo
    - id: concepts-final
